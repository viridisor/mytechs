<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TECHURLS | 7 Columns</title>
    <style>
        :root { --bg-color: #fcfcfc; --header-bg: #1a1a1a; --link-color: #0055aa; }
        body { font-family: -apple-system, sans-serif; background: var(--bg-color); margin: 0; font-size: 13px; }
        header { background: var(--header-bg); color: white; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; }
        .main-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; padding: 20px; }
        .site-column { border-top: 4px solid #333; padding-top: 8px; margin-bottom: 20px; }
        .site-name { font-weight: 800; font-size: 14px; text-transform: uppercase; color: #000; text-decoration: none; display: block; margin-bottom: 8px; }
        .article-list { list-style: none; padding: 0; margin: 0; }
        .article-item { margin-bottom: 6px; display: flex; line-height: 1.3; }
        .time-badge { font-size: 10px; color: #999; min-width: 32px; font-family: monospace; }
        .article-link { text-decoration: none; color: var(--link-color); }
        #error-msg { color: red; text-align: center; padding: 20px; display: none; }
        #loading { text-align: center; padding: 50px; color: #666; }
    </style>
</head>
<body>

<header><h1>TECHURLS</h1></header>

<div id="loading">正在加载 7 个垂直领域资讯...</div>
<div id="error-msg"></div>
<div class="main-container" id="content-grid"></div>

<script>
    async function loadNews() {
        const grid = document.getElementById('content-grid');
        const loader = document.getElementById('loading');
        const errorEl = document.getElementById('error-msg');

        // 尝试加载数据的路径，加上时间戳防止浏览器缓存旧数据
        const dataPath = './data/data.json?t=' + new Date().getTime();

        try {
            console.log("正在尝试请求数据: ", dataPath);
            const response = await fetch(dataPath);
            
            if (!response.ok) {
                throw new Error(`HTTP 错误! 状态码: ${response.status} (检查 data/data.json 是否存在)`);
            }

            const data = await response.json();
            console.log("解析成功，数据长度: ", data.length);

            if (!Array.isArray(data)) {
                throw new Error("JSON 格式错误：最外层应该是 [ ] 数组格式。");
            }

            loader.style.display = 'none';
            grid.innerHTML = data.map(site => `
                <div class="site-column">
                    <a href="${site.url || '#'}" class="site-name">${site.source}</a>
                    <ul class="article-list">
                        ${site.articles.map(art => `
                            <li class="article-item">
                                <span class="time-badge">${art.time || '1h'}</span>
                                <a href="${art.link}" class="article-link" target="_blank">${art.title}</a>
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');

        } catch (e) {
            console.error("加载失败原因: ", e);
            loader.style.display = 'none';
            errorEl.style.display = 'block';
            errorEl.innerHTML = `加载失败: ${e.message}<br><small>请确保 data 文件夹内有 data.json 且内容为合法的 JSON 数组。</small>`;
        }
    }

    window.onload = loadNews;
</script>
</body>
</html>
